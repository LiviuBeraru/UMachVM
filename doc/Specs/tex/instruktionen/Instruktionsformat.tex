\section{Instruktionsformate}
\index{Instruktionsformat}

\paragraph{Instruktionsbreite}
\index{Instruktionsbreite}
Jede UMach-Instruktion hat eine feste Bitlänge von 32 Bit (4 mal 8 Bit).
Das gilt unabhängig davon, was die Instruktion tut. Instruktionen, die für ihren
Informationsgehalt weniger als 32 Bit brauchen, wie z.B. \texttt{NOP},
werden mit Nullbits gefüllt. Alle Daten und Informationen, die mit einer
Instruktion übergeben werden, müssen in diesen 32 Bit untergebracht werden.

\paragraph{Byte Order}
\index{Byte Order}
Die Byte Order (Endianness) der gelesenen \glspl{Byte} ist
big-endian, die Byte-Reihenfolge, die für den Mensch selbstverständlich wäre
(von links nach rechts lesen):
die zuerst gelesenen 8 Bits sind die 8 höchstwertigen (Wertigkeiten $2^{31}$ bis
$2^{24}$) und die zuletzt gelesenen Bits sind die niedrigstwertigen
(Wertigkeiten $2^{7}$ bis $2^{0}$).
Bits werden in Stücken von $n$ Bits gelesen, wobei $n = k \cdot 8$ und
$k \in \mathbb{N} \setminus\{0\}$ (Byte für Byte).


\paragraph{Allgemeines Format}
Jede \gls{Instruktion} besteht aus zwei Teilen: der erste Teil ist
8 Bit lang und entspricht dem tatsächlichen \gls{Befehl}, bzw. der Operation,
die von der UMach virtuellen Maschine ausgeführt werden soll.
Dieser 8-Bit-Befehl belegt also die 8 höchstwertigen Bits einer Instruktion.
Die übrigen 24 Bit werden für Operanden oder Daten benutzt. Beispiel einer
Instruktionszerlegung:

\begin{center}
  \begin{tabular}{|l|*{4}{c|}}
    \hline
    Instruktion (32 Bit) &
    \texttt{00000001} & \texttt{00000010} & \texttt{00000011} & \texttt{00000100}
    \\\hline
    Hexa  &
    \texttt{01}   & \texttt{02}   & \texttt{03}   & \texttt{04}
    \\\hline
    Byte Order &
    erstes Byte   & zweites Byte  & drittes Byte  & viertes Byte
    \\\hline
    Interpretation &
    Befehl (8 Bit) &  \multicolumn{3}{c|}{Operanden, Daten oder Füllbits}
    \\\hline
  \end{tabular}
\end{center}

Die Instruktionsformate unterscheiden sich lediglich darin, wie sie die 24 Bits
nach dem 8-Bit \gls{Befehl} verwenden. Das wird auch in der 3-buchstabigen
Benennung deren Formate wiedergeben.

In den folgenden Abschnitten werden die UMach-Instruktionsformate vorgestellt.
Jede Angegebene Tabelle gibt in der ersten Zeile die Reihenfolge der Bytes an. 
Die nächste Zeile gibt die spezielle Belegung der einzelnen Bytes an.



\subsection{000}
\index{Instruktionsformat!000}
\index{000}

\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    Befehl      & \multicolumn{3}{c|}{nicht verwendet}         \\\hline
  \end{tabular}
\end{center}

Eine Instruktion, die das Format 000 hat, besteht lediglich aus einem Befehl
ohne Argumenten. Die letzen drei Bytes werden von der Maschine nicht
ausgewertet und sind somit Füllbytes. Es wird empfohlen, die letzten 3 Bytes mit
Nullen zu füllen.




\subsection{NNN}
\index{Instruktionsformat!NNN}
\index{NNN}

\begin{center}
  \begin{tabular}{|*{4}{c|}}
    \hline
    erstes Byte  & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    Befehl       & \multicolumn{3}{c|}{numerische Angabe}       \\\hline
  \end{tabular}
\end{center}

Die Instruktion im Format NNN besteht aus einem Befehl im ersten Byte und aus
einer numerischen Angabe (einer Zahl), die die letzten 3 Bytes belegt.
Die Interpretation der numerischen Angabe wird dem jeweiligen Befehl überlassen,
jedoch wird diese meistens eine Adresse oder ein Versatz bedeuten.


\subsection{RNN}
\label{subsec:RNN}
\index{Instruktionsformat!RNN}
\index{RNN}

\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    Befehl      & $R$ & \multicolumn{2}{c|}{numerische Angabe} \\\hline
  \end{tabular}
\end{center}

Eine Instruktion im Format RNN besteht aus einem Befehl, gefolgt von einer
Register Nummer, gefolgt von einer festen Zahl, die die letzten 2 Bytes der
Instruktion belegt. Die genaue Interpretation der Zahl wird dem jeweiligen
Befehl überlassen.
Zum Beispiel, die Instruktion
\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    \texttt{0x12} & \texttt{0x01} & \texttt{0x02} & \texttt{0x03} \\\hline
  \end{tabular}
\end{center}
wird folgenderweise von der UMach Maschine interpretiert: die Operation mit
Nummer \texttt{0x12} soll ausgeführt werden, wobei die Argumenten dieser
Operation sind das Register mit Nummer \texttt{0x01} und die numerische
Angabe \texttt{0x0203}.



\subsection{RRN}
\label{subsec:RRN}
\index{Instruktionsformat!RRN}
\index{RRN}

\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte  & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    Befehl       & $R_{1}$       & $R_{2}$ & numerische Angabe  \\\hline
  \end{tabular}
\end{center}
Eine Instruktion im Format RRN besteht aus einem Befehl, gefolgt von der
Angabe zweier Registers, jeweils in einem Byte, gefolgt von einer numerischen
Angabe (festen Zahl) im letzten Byte. Zum Beispiel, die Instruktion
\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    \texttt{0x12} & \texttt{0x01} & \texttt{0x02} & \texttt{0x03} \\\hline
  \end{tabular}
\end{center}
soll wie folgt interpretiert werden: 
die Operation mit Nummer \texttt{0x12} soll ausgeführt werden, wobei die
Argumenten dieser Operation sind Register mit Nummer \texttt{0x01}, Register mit
Nummer \texttt{0x02} und die Zahl \texttt{0x03}.



\subsection{RRR}
\label{subsec:RRR}
\index{Instruktionsformat!RRR}
\index{RRR}

\begin{center}
  \begin{tabular}{|*{4}{c|}} \hline
    erstes Byte & zweites Byte  & drittes Byte  & viertes Byte \\\hline\hline
    Befehl      & $R_{1}$       & $R_{2}$       & $R_{3}$      \\\hline
  \end{tabular}
\end{center}

Eine Instruktion im Format RRR besteht aus der Angabe eines Befehls im ersten
Byte, gefolgt von der Angabe dreier Register in den jeweiligen folgenden drei
Bytes. Die Register werden als Zahlen angegeben und deren Bedeutung hängt vom
jeweiligen Befehl ab.


\subsection{Zusammenfassung}
Im folgenden werden die Instruktionsformate tabellarisch zusammengefasst.

\index{Instruktionsformat!Liste}
\begin{center}
  \begin{tabular}{|l||*{4}{c|}}
    \hline
    Format & erstes Byte & zweites Byte  & drittes Byte  & viertes Byte
    \\\hline\hline
    000 & Befehl & \multicolumn{3}{c|}{nicht verwendet}       \\\hline
    NNN & Befehl & \multicolumn{3}{c|}{numerische Angabe}       \\\hline
    RNN & Befehl & $R$ & \multicolumn{2}{c|}{numerische Angabe} \\\hline
    RRN & Befehl & $R_{1}$ & $R_{2}$ & numerische Angabe        \\\hline
    RRR & Befehl & $R_{1}$ & $R_{2}$ & $R_{3}$                  \\\hline
  \end{tabular}
\end{center}



